ğŸ“Œ KRP êµ¬í˜„ êµ¬ì¡° ì •ë¦¬
1. ë¼ìš°íŠ¸ ì„¤ê³„

GET /KRP?storeId=:storeId â†’ íŠ¹ì • ë§¤ì¥ì˜ KRP ì‹œë®¬ë ˆì´í„° í˜ì´ì§€ ë Œë”ë§

ì´ í˜ì´ì§€ì—ì„œ í•´ë‹¹ ë§¤ì¥ ì£¼ë¬¸ì„ ë¶ˆëŸ¬ì™€ â€œì¶œë ¥â€ ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ê°€ì§œ ì£¼ë¬¸ì„œ(ì˜ìˆ˜ì¦ UI)ê°€ ìŒ“ì´ë„ë¡ êµ¬í˜„

2. ì„œë²„ ì½”ë“œ (Express ì˜ˆì‹œ)
// routes/krp.js
const express = require('express');
const router = express.Router();
const pool = require('../shared/config/database');

// KRP í™”ë©´ ë¼ìš°íŠ¸
router.get('/', async (req, res) => {
  const { storeId } = req.query;

  try {
    const result = await pool.query(
      `SELECT o.id, o.table_number, oi.menu_name, oi.qty
       FROM orders o
       JOIN order_items oi ON o.id = oi.order_id
       WHERE o.store_id = $1
       ORDER BY o.created_at DESC`,
      [storeId]
    );

    res.render('krp', { orders: result.rows, storeId });
  } catch (err) {
    console.error(err);
    res.status(500).send('KRP Error');
  }
});

module.exports = router;

3. í”„ë¡ íŠ¸ (krp.ejs or krp.html)
<div id="kitchenReceipts">
  <h2>ğŸ³ ì£¼ë°© ì£¼ë¬¸ì„œ ì¶œë ¥ê¸° (Store: <%= storeId %>)</h2>
  <button onclick="simulatePrint()">ìƒ˜í”Œ ì¶œë ¥</button>
</div>

<script>
  function simulatePrint(order = {
    id: 1,
    table_number: "A-1",
    items: [
      { qty: 2, name: "ê¹€ì¹˜ì°Œê°œ" },
      { qty: 1, name: "ë¶ˆê³ ê¸°ë®ë°¥" }
    ]
  }) {
    const receiptArea = document.getElementById('kitchenReceipts');

    const receipt = document.createElement('div');
    receipt.classList.add('receipt');

    receipt.innerHTML = `
      <h3>ğŸ´ ì£¼ë°© ì£¼ë¬¸ì„œ</h3>
      <p><b>í…Œì´ë¸”:</b> ${order.table_number}</p>
      <hr>
      <ul>
        ${order.items.map(item => `<li>${item.qty} x ${item.name}</li>`).join('')}
      </ul>
      <hr>
      <p>ì£¼ë¬¸ë²ˆí˜¸: ${order.id}</p>
      <p>ì‹œê°„: ${new Date().toLocaleTimeString()}</p>
    `;

    receiptArea.appendChild(receipt);
  }
</script>

<style>
  .receipt {
    border: 1px dashed #000;
    background: #fff;
    margin: 10px 0;
    padding: 10px;
    font-family: monospace;
    width: 250px;
  }
</style>

4. íë¦„ ìš”ì•½

/KRP?storeId=123 ì ‘ì† â†’ í•´ë‹¹ ë§¤ì¥ ì£¼ë¬¸ ë°ì´í„° ì¡°íšŒ

í˜ì´ì§€ì—ì„œ ì£¼ë¬¸ì„ ì„ íƒ/ì™„ë£Œ ì‹œ simulatePrint(order) í˜¸ì¶œ

ì‹¤ì œ í”„ë¦°í„° ëŒ€ì‹  í™”ë©´ì— ì˜ìˆ˜ì¦ í˜•íƒœ ë°•ìŠ¤ê°€ ëˆ„ì ë¨

ì „ì—­ ì´í›„ì—” simulatePrint ë¶€ë¶„ì„ escpos ê°™ì€ ì‹¤ì œ ì¶œë ¥ í•¨ìˆ˜ë¡œ êµì²´í•˜ë©´ ë¨

ğŸ“Œ ì •ë¦¬:
KRPëŠ” **ë³„ë„ ë¼ìš°íŠ¸(/KRP)**ë¡œ ë‘ê³ ,
í˜„ì¬ëŠ” ì‹œë®¬ë ˆì´í„°(UIë¡œ ì¶œë ¥) + **DBì—°ë™(ë§¤ì¥ ì£¼ë¬¸ ì¡°íšŒ)**ë§Œ êµ¬í˜„í•˜ë©´ ë¼.
ì´ êµ¬ì¡°ë©´ ë‚˜ì¤‘ì— ë°”ë¡œ ë¬¼ë¦¬ í”„ë¦°í„° ë¶™ì¼ ìˆ˜ ìˆìŒ.