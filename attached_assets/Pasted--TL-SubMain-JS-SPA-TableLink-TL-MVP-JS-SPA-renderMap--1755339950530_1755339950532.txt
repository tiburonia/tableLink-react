[요청] TL SubMain 화면 구현 (바닐라 JS SPA)
배경

TableLink(TL) 웹 MVP, 바닐라 JS 기반 SPA.

메인은 지도 화면(renderMap). 그 옆 탭으로 서브메인(SubMain) 화면을 새로 만든다.

목적: 유저가 자주 쓰는 기능을 2~3탭 이내로 실행. 스켈레톤 먼저, 데이터 나중.

요구사항 요약

파일 생성:

TLG/pages/renderSubMain.js

TLG/styles/subMain.css

전역 네비게이션에 홈(🏠)=SubMain, 검색(🔍), 지도(📍), 마이(👤) 탭이 있고, 홈 탭을 누르면 renderSubMain() 호출.

프레임워크 사용 금지(바닐라 JS). DOMContentLoaded 없이 동작.

뷰는 한번에 렌더하고, 섹션별로 스켈레톤 → 실제 데이터 교체.

화면 구성

헤더

좌: 로고 TableLink

우: QR 버튼(📱), 알림(🔔)

퀵 액션(빠른 실행)

버튼 4개: QR주문(TLL), 예약(TLA), 포장(TLA), 쿠폰/포인트(TLR)

단골 & 최근

가로 스크롤 칩 카드(썸네일, 가게명, 평점). 없으면 “아직 기록이 없어”

내 주변 추천

세로 카드 리스트(썸네일, 이름, 평점/카테고리, 거리) + 카드 우하단 QR 미니 버튼

무한 스크롤(IntersectionObserver) 또는 “더보기” 버튼

혜택(TLP)

배너 1장만. 없으면 “진행 중 혜택이 없어”

하단 네비

기존 네비 그대로. 홈 탭 활성화 표시.

함수/이벤트 설계

renderSubMain() : 엔트리. 레이아웃 + 스켈레톤 렌더 → 병렬 데이터 로드 → 섹션 교체 → 무한 스크롤 init

데이터 로드(초기 병렬):

apiFetchFavorites() → [ {id,name,rating,thumb} ]

apiFetchRecentStores() → 동일 스키마

apiFetchNearby({offset,limit}) → 동일 스키마 + category, distanceText

apiFetchPromotions() → [ {title, banner, deeplink} ]

네비 타깃(이미 프로젝트에 있을 수 있음 → 있으면 그 함수 호출만 연결):

TLL() / TLLForStore(storeId)

renderReservation() / renderTakeoutHub() / renderBenefits() / renderStoreById(id)

오류 처리: 섹션 단위 인라인 에러(showInlineError(containerSelector, msg)), 전체 블로킹 금지.

API 계약(실서버 붙기 전 임시 스텁 허용)
async function apiFetchFavorites(){ return window.DEMO_FAV || []; }
async function apiFetchRecentStores(){ return window.DEMO_RECENT || []; }
async function apiFetchNearby({offset=0, limit=10}){ 
  const src = window.DEMO_NEARBY || [];
  return src.slice(offset, offset+limit);
}
async function apiFetchPromotions(){ return window.DEMO_PROMOS || []; }


추후 실제 API로 교체 가능한 구조로 작성(함수 시그니처 유지).

렌더 스켈레톤 → 교체 패턴 (필수)

renderQuickActionsSkeleton() → replaceQuickActions()

renderFavSkeleton() → replaceFavSection(fav,recent)

renderNearbySkeleton() → replaceNearbySection(list)

renderPromoSkeleton() → replacePromoSection(promos)

무한 스크롤: initNearbyInfiniteScroll() + loadMoreNearby()

CSS 가이드 (핵심)

카드 공통: border-radius: 16px; box-shadow: 0 4px 12px rgba(0,0,0,.06); padding: 12-16px;

터치 타겟 최소 44x44px

h-scroll 스냅, v-list 간격 10px

스켈레톤 애니메이션(샤이머) 간단히

헤더 sticky, 하단 네비와 겹치지 않도록 #subContent 하단 패딩(네비 높이만큼)

수락 기준(AC)

renderSubMain() 호출 시:

헤더/퀵액션/단골&최근/내주변/혜택 섹션의 스켈레톤이 즉시 표시되어야 함(100ms 내).

데이터 로드 후 각 섹션이 정상 교체되어야 함.

즐겨찾기/최근/내주변 데이터가 비어도 UI 깨지지 않음, “기록 없음”/“혜택 없음” 표시.

내 주변 섹션에서 무한 스크롤로 데이터 추가 로드. 더 이상 없으면 버튼/옵저버 해제.

각 액션 버튼 동작:

QR 버튼: TLL() 또는 TLLForStore(storeId)

매장 카드 클릭: renderStoreById(id) 호출

예약/포장/혜택 버튼: 해당 허브 함수 호출(더미라도 라우팅 확인 가능)

스타일:

모바일 390×844 기준 레이아웃 안정(오버플로/겹침 없음)

하단 네비와 컨텐츠 겹치지 않음

코드 품질:

전역 오염 최소화(모듈 스코프 또는 네임스페이스 오브젝트)

하드코딩된 DOM id/class는 renderSubMain 내에서 일관되게 사용

주석: 섹션/함수 목적, 교체 타이밍 명시

제공 함수 존재 가정

TLL, TLLForStore, renderReservation, renderTakeoutHub, renderBenefits, renderStoreById, showInlineError

없다면 빈 스텁 함수로라도 생성해 연결(콘솔만 찍어도 됨).

산출물

TLG/pages/renderSubMain.js : 상기 로직 전체

TLG/styles/subMain.css : 공통 카드/리스트/스켈레톤/헤더/배너 스타일

기존 네비에서 홈 탭 클릭 시 renderSubMain() 호출되도록 연결

추가 메모

프레임워크/외부 라이브러리 사용 금지.

함수 분리/가독성 유지. 섹션별 렌더/교체/헬퍼 구분.

이후 실제 API로 바꿀 때 함수 시그니처 변경 없이 대체 가능해야 함.