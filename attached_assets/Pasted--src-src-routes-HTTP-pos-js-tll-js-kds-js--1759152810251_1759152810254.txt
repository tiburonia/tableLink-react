ğŸ“‚ src í´ë” êµ¬ì¡° ì œì•ˆ
src/
  routes/               # HTTP ì—”ë“œí¬ì¸íŠ¸ ë¼ìš°íŒ…
    pos.js
    tll.js
    kds.js
    tlm.js
    ...
  controllers/          # ìš”ì²­ ë‹¨ìœ„ ì œì–´ (req, res)
    posController.js
    tllController.js
    kdsController.js
    ...
  services/             # ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
    orderService.js
    paymentService.js
    tableService.js
    ...
  repositories/         # DB ì ‘ê·¼ ê³„ì¸µ (SQL/ORM)
    orderRepository.js
    tableRepository.js
    userRepository.js
    ...
  models/               # DB ëª¨ë¸ ì •ì˜ (SQL ìŠ¤í‚¤ë§ˆ or ORM ëª¨ë¸)
    Order.js
    Table.js
    User.js
    ...
  middleware/           # ë¯¸ë“¤ì›¨ì–´
    auth.js
    errorHandler.js
    validator.js
  utils/                # ê³µìš© ìœ í‹¸ë¦¬í‹°
    db.js               # pool, transaction ê´€ë¦¬
    eventBus.js
    logger.js
    ...
  events/               # ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ (KDS ì•Œë¦¼, WebSocket ë“±)
    orderEvents.js
    ...
  config/               # í™˜ê²½ì„¤ì •
    dbConfig.js
    appConfig.js
  index.js              # ì„œë²„ ì§„ì…ì  (Express app)
  app.js                # Express ì„¤ì •

ğŸ“Œ ê° ë ˆì´ì–´ ì—­í• 
1. routes/

ë‹¨ìˆœíˆ router.get, router.postë§Œ ì •ì˜

ì–´ë–¤ URL â†’ ì–´ë–¤ controller ë¡œ ì—°ê²°í• ì§€ë§Œ ê´€ë¦¬
ì˜ˆ: routes/pos.js

const router = require('express').Router();
const posController = require('../controllers/posController');

router.post('/orders/modify-batch', posController.modifyBatch);

module.exports = router;

2. controllers/

req.body, req.params, res.json() ê°™ì€ HTTP ë ˆë²¨ ì²˜ë¦¬

ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì€ serviceì— ìœ„ì„
ì˜ˆ: controllers/posController.js

const orderService = require('../services/orderService');

exports.modifyBatch = async (req, res, next) => {
  try {
    const result = await orderService.modifyBatch(req.body);
    res.json({ success: true, ...result });
  } catch (err) {
    next(err);
  }
};

3. services/

ìˆœìˆ˜ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ë‹´ë‹¹ (íŠ¸ëœì­ì…˜, ì´ë²¤íŠ¸, ì¡°ê±´ ë¶„ê¸°)

repositoryë¥¼ í˜¸ì¶œí•´ ë°ì´í„° ì¡°ì‘
ì˜ˆ: services/orderService.js

const orderRepo = require('../repositories/orderRepository');

exports.modifyBatch = async ({ storeId, tableNumber, modifications }) => {
  const client = await orderRepo.getClient();
  try {
    await client.query('BEGIN');
    const orderId = await orderRepo.getOrCreateActiveOrder(client, storeId, tableNumber);
    // ... add/remove ì²˜ë¦¬ ...
    await client.query('COMMIT');
    return { orderId, message: "ìˆ˜ì • ì™„ë£Œ" };
  } catch (e) {
    await client.query('ROLLBACK');
    throw e;
  } finally {
    client.release();
  }
};

4. repositories/

DB SQL ì „ìš© ê³„ì¸µ (queryBuilder/ORM)

SQLì„ í•œ ê³³ì— ëª¨ì•„ë‘ë©´ ë‚˜ì¤‘ì— DB ë¦¬íŒ©í† ë§í•˜ê¸° í¸í•¨

5. models/

ORMì„ ì“¸ ê²½ìš°(Entity ì •ì˜)

ì§ì ‘ SQLë§Œ ì“°ë©´ ì´ í´ë”ëŠ” ì„ íƒì‚¬í•­

6. middleware/

ì¸ì¦, ê¶Œí•œ ì²´í¬, ìœ íš¨ì„± ê²€ì‚¬, ì—ëŸ¬ í•¸ë“¤ë§

7. utils/

ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ê³µí†µ í•¨ìˆ˜

logger, eventBus, ë‚ ì§œ í¬ë§·í„°, response formatter

8. events/

KDS ì´ë²¤íŠ¸, WebSocket, Pub/Sub

ì£¼ë¬¸ ìˆ˜ì • ì‹œ eventBus.emit('order.modified', ...) ê°™ì€ ë¡œì§ ë¶„ë¦¬

9. config/

DB ì»¤ë„¥ì…˜, ì„œë²„ í¬íŠ¸, í™˜ê²½ ë³€ìˆ˜

ğŸ“Œ ìš”ì•½:

routes: URLë§Œ â†’ controller: HTTP ì²˜ë¦¬ â†’ service: ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ â†’ repository: DB

ì—¬ê¸°ì— middleware, utils, config, eventsê¹Œì§€ ëª¨ë“ˆí™”

ğŸ‘‰ ì´ë ‡ê²Œ ê°€ë©´ TL ì „ì²´(TLL/POS/KDS/TLM) êµ¬ì¡°ê°€ ì»¤ì ¸ë„, ê° ë ˆì´ì–´ê°€ ë¶„ë¦¬ë¼ì„œ ê´€ë¦¬ê°€ ê¹”ë”í•´ì ¸.