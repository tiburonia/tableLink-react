. ë ˆê±°ì‹œ ì‹œìŠ¤í…œ ì™„ì „ ì°¨ë‹¨
import/ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ ì œê±°

index.html/ì—”íŠ¸ë¦¬ì—ì„œ legacyMarkerManager.js ë¡œë“œ ë¼ì¸ ì œê±°.

ë‹¤ë¥¸ íŒŒì¼ì—ì„œ legacyMarkerManager ê´€ë ¨ import ì „ì²´ ì‚­ì œ.

í˜¸ì¶œ ê²½ë¡œ ì°¨ë‹¨

renderMap.js, store/map/*, events/* ë“±ì—ì„œ ì•„ë˜ í‚¤ì›Œë“œ ì „ìˆ˜ ê²€ìƒ‰í•´ ì œê±°/ì£¼ì„:

LegacyMarkerManager, legacyMarkerManager, renderLegacyMarkers, updateLegacyMarkers, ìë©´ë™, dong, umyeon, aggregateByDong

í˜¹ì‹œ ë‚¨ì•„ìˆìœ¼ë©´ ì„ì‹œë¡œ ë°©ì–´:

js
ë³µì‚¬
í¸ì§‘
// guard.js (ì•± ì´ˆê¸° ë¡œë“œ ì‹œ)
window.LegacyMarkerManager = new Proxy({}, {
  get() { 
    console.warn('ğŸš« LegacyMarkerManager í˜¸ì¶œ ì°¨ë‹¨'); 
    return () => {};
  }
});
â†’ ë‚¨ì€ í˜¸ì¶œì´ ìˆìœ¼ë©´ ì½˜ì†” ê²½ê³ ë¡œ ì¡íˆê²Œ.

ESLint ë£°(ì„ íƒ)

no-restricted-importsë¡œ legacyMarkerManager.js ê¸ˆì§€.

B. íƒ€ì¼ ì‹œìŠ¤í…œ ì´ˆê¸°í™” ê°•ì œ
renderMap.js ë‚´ ì§€ë„ ìƒì„± ì§í›„ ë‹¨ í•œ ì¤„ í™•ì‹¤íˆ í˜¸ì¶œ:

js
ë³µì‚¬
í¸ì§‘
import { MapMarkerManager } from './mapMarkerManager.js';

export async function renderMap() {
  const map = initKakaoMap(); // ê¸°ì¡´ ë¡œì§
  window.__MAP__ = map; // ë””ë²„ê¹… í¸ì˜

  // âœ… íƒ€ì¼ ì‹œìŠ¤í…œ ì´ˆê¸°í™”
  MapMarkerManager.initialize(map, {
    debounceMs: 180,
    maxVisibleMarkers: 400
  });
}
ì¤‘ë³µ ë°©ì§€: initializeê°€ ì—¬ëŸ¬ ë²ˆ ë¶ˆë ¤ë„ ì•ˆì „í•˜ë„ë¡ idempotent ì²˜ë¦¬:

js
ë³µì‚¬
í¸ì§‘
// mapMarkerManager.js
let _initialized = false;

export const MapMarkerManager = {
  initialize(map, opts = {}) {
    if (_initialized) { 
      console.log('â„¹ï¸ MapMarkerManager already initialized'); 
      return; 
    }
    _initialized = true;
    this.map = map;
    this.opts = { debounceMs: 180, maxVisibleMarkers: 400, ...opts };
    this._wireEvents();
    this._refreshTiles('init');
  },
  // ...
};
ì´ë²¤íŠ¸ ì—°ê²°

ì¹´ì¹´ì˜¤ë§µ idleì—ë§Œ ë¬¶ê³ , zoom_changed, drag ë“±ì—ì„œëŠ” í˜¸ì¶œ ê¸ˆì§€(ì¤‘ë³µ ë°©ì§€).

ë‚´ë¶€ì—ì„œ AbortController + debounce ì ìš©.

ë¡œê·¸ í¬ë§· ê³ ì •:

íƒ€ì¼ ìš”ì²­: ğŸ“¡ tiles z/x/y ìš”ì²­

ìºì‹œ ì ì¤‘: âœ… íƒ€ì¼ ìºì‹œë¨ z/x/y

ë Œë” ë: ğŸ–¼ï¸ ìº”ë²„ìŠ¤ ë Œë” ì™„ë£Œ count=N

C. íƒ€ì¼ ë Œë” ê²½ë¡œ ê³ ì •(ë‹¨ì¼ ì†ŒìŠ¤)
ìº”ë²„ìŠ¤ ë ˆì´ì–´ 1ì¥ë§Œ ì‚¬ìš©í•˜ê³ , Kakao Marker/CustomOverlay ëŒ€ëŸ‰ ìƒì„± ê¸ˆì§€.

diff ë Œë”(ì¶”ê°€/ì‚­ì œë§Œ) ì ìš©.

D. í™˜ê²½ í”Œë˜ê·¸ë¡œ í† ê¸€(í˜¹ì‹œ ë¡¤ë°± ëŒ€ë¹„)
ì „ì—­ window.FEATURE_TILE_MARKERS = true ê¸°ë³¸ê°’ on.

if (!window.FEATURE_TILE_MARKERS) return; ê°€ë“œ í•œ ì¤„ë¡œ ì „ì²´ ë¹„í™œì„± ê°€ëŠ¥.

E. í…ŒìŠ¤íŠ¸ & ìˆ˜ë½ ê¸°ì¤€
í˜ì´ì§€ ë¡œë“œ â†’ ë ˆê±°ì‹œ ë¡œê·¸ ì „í˜€ ì—†ìŒ(íŠ¹íˆ ğŸ”„ ì§€ë„ ë ˆë²¨ 7 ë³€ê²½, ìë©´ë™ ì§‘ê³„).

ì§€ë„ ì´ë™/ì¤Œ í›„ íƒ€ì¼ ë¡œê·¸ ì¶œë ¥ í™•ì¸:

ğŸ“¡ tiles ... â†’ âœ… íƒ€ì¼ ìºì‹œë¨ ... â†’ ğŸ–¼ï¸ ìº”ë²„ìŠ¤ ë Œë” ì™„ë£Œ count=...

ë¹ ë¥´ê²Œ ë“œë˜ê·¸/ì¤Œí•´ë„ ì¤‘ë³µ ìš”ì²­ ì·¨ì†Œ(AbortError ì œì™¸) ë° FPS ìœ ì§€.

í´ëŸ¬ìŠ¤í„° í´ë¦­ ì‹œ ì¤Œ ì¸ ë™ì‘(ë˜ëŠ” í•˜ìœ„ ìš”ì²­) ì •ìƒ.

ì°¸ê³ (í•„ìš”ì‹œ ë„£ì–´ì¤˜)
ì„¤ì¹˜ ë³´ì¥: npm i supercluster @mapbox/tilebelt

ì„œë²„ /api/tilesëŠ” ë™ì‘ í™•ì¸ë¨ â†’ FEë§Œ ì—°ê²° ì •ë¦¬í•˜ë©´ ë¨.

ë³€ê²½ì´ í•„ìš”í•œ ëŒ€í‘œ íŒŒì¼
public/index.html or ì—”íŠ¸ë¦¬: legacyMarkerManager.js ì œê±°

src/renderMap.js: MapMarkerManager.initialize(map) í˜¸ì¶œ ì¶”ê°€

src/mapMarkerManager.js: idempotent init + idle ì´ë²¤íŠ¸ + Abort/debounce + ìº”ë²„ìŠ¤ ë Œë”

src/guard.js(ì„ íƒ): ë ˆê±°ì‹œ í˜¸ì¶œ ê°€ë“œ