const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/mapService-Bzq_iPxu.js","assets/preload-helper-BXl3LOEh.js"])))=>i.map(i=>d[i]);
import{_ as s}from"./preload-helper-BXl3LOEh.js";let l,o,c;try{const e=await s(()=>import("./mapService-Bzq_iPxu.js"),__vite__mapDeps([0,1])),t=await s(()=>import("./mapView-DxfiQPpC.js"),[]),n=await s(()=>import("./mapLevelConverter-B-gJDh-V.js"),[]);l=e.mapService,o=t.mapView,c=n.mapLevelConverter}catch(e){console.warn("âš ï¸ ES6 ëª¨ë“ˆ ì„í¬íŠ¸ ì‹¤íŒ¨, ì „ì—­ ê°ì²´ ì‚¬ìš©:",e),l=window.mapService,o=window.mapView,c=window.mapLevelConverter}c?window.mapLevelConverter=c:(window.mapLevelConverter={naverZoomToKakaoLevel:e=>Math.max(1,Math.min(14,28-e)),kakaoLevelToNaverZoom:e=>Math.max(6,Math.min(21,28-e))},console.warn("âš ï¸ mapLevelConverter í´ë°± ì‚¬ìš©"));const m={state:{map:null,userLocation:null,mapCenter:null,searchTimeout:null,userMarker:null,searchClickListenerAdded:!1,searchClickHandler:null,selectedRegion:{province:null,city:null,district:null}},async initializeMap(){console.log("ğŸ—ºï¸ ì§€ë„ ì»¨íŠ¸ë¡¤ëŸ¬ ì´ˆê¸°í™” ì‹œì‘");try{o.renderMapUI();const e=document.getElementById("map"),t={center:new naver.maps.LatLng(37.5665,126.978),zoom:16,maxZoom:18,minZoom:6};this.state.map=new naver.maps.Map(e,t),window.currentMap=this.state.map,this.setupMapEvents(),this.setupUIEvents(),await this.loadInitialData(),this.connectMapPanelUI(),this.state.isInitialized=!0,console.log("âœ… ì§€ë„ ì»¨íŠ¸ë¡¤ëŸ¬ ì´ˆê¸°í™” ì™„ë£Œ")}catch(e){console.error("âŒ ì§€ë„ ì´ˆê¸°í™” ì‹¤íŒ¨:",e),o.showError("ì§€ë„ ë¡œë”©ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•´ì£¼ì„¸ìš”.")}},setupMapEvents(){const e=this.state.map;naver.maps.Event.addListener(e,"zoom_changed",async()=>{const t=this.state.map.getZoom();console.log(`ğŸ”„ ì§€ë„ ë³€ê²½ ê°ì§€ - ì¤Œ ë ˆë²¨: ${t}`),await this.handleMapChange()}),naver.maps.Event.addListener(e,"dragend",()=>{this.handleMapChange()}),naver.maps.Event.addListener(e,"idle",()=>{this.updateLocationInfo()}),console.log("âœ… ì§€ë„ ì´ë²¤íŠ¸ ì„¤ì • ì™„ë£Œ")},setupUIEvents(){document.getElementById("searchBtn")?.addEventListener("click",()=>{typeof renderSearch=="function"&&renderSearch()}),document.getElementById("notificationBtn")?.addEventListener("click",async()=>{if(typeof renderNotification=="function")renderNotification();else if(window.renderNotification)window.renderNotification();else{const{default:e}=await s(async()=>{const{default:t}=await import("/TLG/pages/main/renderNotification.js");return{default:t}},[]);e&&e()}}),document.getElementById("currentLocationBtn")?.addEventListener("click",()=>{this.moveToCurrentLocation()}),this.setupLocationEvents()},setupSearchEvents(){const e=document.getElementById("searchInput"),t=document.getElementById("searchBtn"),n=document.getElementById("clearBtn");e.addEventListener("click",()=>{typeof renderSearch=="function"&&renderSearch("")}),t.addEventListener("click",()=>{const a=e.value.trim();typeof renderSearch=="function"&&renderSearch(a)}),e.addEventListener("keypress",a=>{if(a.key==="Enter"){a.preventDefault();const i=e.value.trim();typeof renderSearch=="function"&&renderSearch(i)}}),n.addEventListener("click",()=>{e.value="",o.hideSearchResults(),n.style.display="none",e.focus()}),this.state.searchClickListenerAdded||(this.state.searchClickHandler=a=>{const i=document.getElementById("searchResults");!e.contains(a.target)&&(!i||!i.contains(a.target))&&!t.contains(a.target)&&o.hideSearchResults()},document.addEventListener("click",this.state.searchClickHandler),this.state.searchClickListenerAdded=!0),n.style.display="none"},setupLocationEvents(){const e=document.getElementById("closeModal"),t=document.getElementById("getCurrentLocationBtn"),n=document.getElementById("confirmLocationBtn");e&&e.addEventListener("click",()=>{this.closeLocationModal()}),t&&t.addEventListener("click",()=>{this.getCurrentGPSLocation()}),n&&n.addEventListener("click",()=>{this.confirmLocationSetting()}),this.setupRegionSelectionEvents()},setupRegionSelectionEvents(){const e=document.getElementById("provinceSelect"),t=document.getElementById("citySelect"),n=document.getElementById("districtSelect"),a=document.getElementById("confirmLocationBtn");e&&e.addEventListener("change",async i=>{const r=i.target.value;r?await this.loadCities(r):(o.resetCityAndDistrictSelects(),a&&(a.disabled=!0))}),t&&e&&t.addEventListener("change",async i=>{const r=i.target.value,p=e.value;p&&r?await this.loadDistricts(p,r):(o.resetDistrictSelect(),a&&(a.disabled=!0))}),n&&a&&n.addEventListener("change",i=>{const r=i.target.value;a.disabled=!r})},setupCartEvents(){document.getElementById("cartBtn").addEventListener("click",()=>{window.savedCart&&window.savedCart.order&&Object.keys(window.savedCart.order).length>0?typeof renderCart=="function"?renderCart(window.savedCart):alert("ì¥ë°”êµ¬ë‹ˆ ê¸°ëŠ¥ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."):alert("ì¥ë°”êµ¬ë‹ˆê°€ ë¹„ì–´ìˆìŠµë‹ˆë‹¤.")}),setInterval(()=>this.updateCartBadge(),1e3),this.updateCartBadge()},setupNavigationEvents(){document.getElementById("renderMapBtn").addEventListener("click",()=>{typeof renderMap=="function"?renderMap():location.reload()})},async handleMapChange(){const e=this.state.map.getZoom();console.log(`ğŸ”„ ì§€ë„ ë³€ê²½ ê°ì§€ - ì¤Œ ë ˆë²¨: ${e}`);try{window.MapMarkerManager&&typeof window.MapMarkerManager.handleMapLevelChange=="function"&&window.MapMarkerManager.handleMapLevelChange(this.state.map),window.MapPanelUI&&typeof window.MapPanelUI.rebuildStorePanel=="function"&&await window.MapPanelUI.rebuildStorePanel(this.state.map)}catch(t){console.error("âŒ ì§€ë„ ë³€ê²½ ì²˜ë¦¬ ì‹¤íŒ¨:",t)}},handleSearchInput(e){clearTimeout(this.state.searchTimeout);const t=document.getElementById("clearBtn");e?(t.style.display="flex",this.state.searchTimeout=setTimeout(()=>{this.performSearch(e)},300)):(t.style.display="none",o.hideSearchResults())},async performSearch(e){if(!e.trim()){o.hideSearchResults();return}console.log(`ğŸ” ê²€ìƒ‰ ìˆ˜í–‰: "${e}"`);try{const{stores:t,places:n}=await l.performUnifiedSearch(e,this.state.map);o.displaySearchResults(t,n,e,this.state.map)}catch(t){console.error("âŒ ê²€ìƒ‰ ì‹¤íŒ¨:",t),o.showSearchError(t.message)}},async openLocationModal(){console.log("ğŸ“ ìœ„ì¹˜ ì„ íƒ ê¸°ëŠ¥ì´ ë¹„í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤"),alert("ìœ„ì¹˜ ì„ íƒ ê¸°ëŠ¥ì´ ë¹„í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤")},closeLocationModal(){document.getElementById("locationModal").classList.add("hidden"),o.resetRegionSelects()},getCurrentGPSLocation(){console.log("ğŸ“ GPS ìœ„ì¹˜ ê¸°ëŠ¥ì´ ë¹„í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤"),alert("GPS ìœ„ì¹˜ ê¸°ëŠ¥ì´ ë¹„í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤")},async confirmLocationSetting(){console.log("ğŸ“ ìœ„ì¹˜ ì„¤ì • í™•ì¸ ê¸°ëŠ¥ì´ ë¹„í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤"),alert("ìœ„ì¹˜ ì„¤ì • ê¸°ëŠ¥ì´ ë¹„í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤")},setMapLocation(e,t,n){const a=new naver.maps.LatLng(e,t);this.state.map.setCenter(a),this.state.map.setZoom(15),o.updateLocationText(n),console.log(`ğŸ“ ì§€ë„ ìœ„ì¹˜ ì´ë™: ${n} (${e}, ${t})`)},async loadProvinces(){console.log("ğŸ“ ì‹œë„ ë°ì´í„° ë¡œë“œ ê¸°ëŠ¥ì´ ë¹„í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤")},async loadCities(e){console.log("ğŸ“ ì‹œêµ°êµ¬ ë°ì´í„° ë¡œë“œ ê¸°ëŠ¥ì´ ë¹„í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤")},async loadDistricts(e,t){console.log("ğŸ“ ìë©´ë™ ë°ì´í„° ë¡œë“œ ê¸°ëŠ¥ì´ ë¹„í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤")},async updateLocationInfo(){console.log("ğŸ“ ìœ„ì¹˜ ì •ë³´ ì—…ë°ì´íŠ¸ ê¸°ëŠ¥ì´ ë¹„í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤"),o.updateLocationText("ì§€ë„")},async loadInitialData(){window.MapMarkerManager&&typeof window.MapMarkerManager.reset=="function"&&window.MapMarkerManager.reset(),setTimeout(()=>{this.handleMapChange()},500),this.updateLocationInfo()},connectMapPanelUI(){setTimeout(()=>{window.MapPanelUI&&(typeof window.MapPanelUI.initializeFiltering=="function"&&window.MapPanelUI.initializeFiltering(),typeof window.MapPanelUI.setupPanelDrag=="function"&&window.MapPanelUI.setupPanelDrag(),typeof window.MapPanelUI.connectToMap=="function"&&window.MapPanelUI.connectToMap(this.state.map))},200)},updateCartBadge(){const e=document.getElementById("cartBadge");if(e)if(window.savedCart&&window.savedCart.order){const t=Object.values(window.savedCart.order).reduce((n,a)=>n+a,0);t>0?(e.textContent=t,e.classList.remove("hidden")):e.classList.add("hidden")}else e.classList.add("hidden")},reset(){console.log("ğŸ”„ ì§€ë„ ì»¨íŠ¸ë¡¤ëŸ¬ ìƒíƒœ ì´ˆê¸°í™”"),this.state.searchClickListenerAdded&&this.state.searchClickHandler&&(document.removeEventListener("click",this.state.searchClickHandler),this.state.searchClickListenerAdded=!1,this.state.searchClickHandler=null),this.state.map=null,this.state.currentMarkers=[],this.state.isInitialized=!1,this.state.searchTimeout&&(clearTimeout(this.state.searchTimeout),this.state.searchTimeout=null)},setupFilterEvents(){const e=document.getElementById("mapFilterToggleBtn"),t=document.getElementById("mapFilterContainer");e&&t&&e.addEventListener("click",()=>{t.classList.toggle("collapsed"),e.classList.toggle("collapsed")}),document.querySelectorAll(".map-filter-tab").forEach(n=>{n.addEventListener("click",()=>{document.querySelectorAll(".map-filter-tab").forEach(a=>a.classList.remove("active")),n.classList.add("active")})})},renderStoreCards(e){const t=document.getElementById("mapStorePanelContainer");if(!t){console.error("âŒ ë§¤ì¥ íŒ¨ë„ ì»¨í…Œì´ë„ˆë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤");return}t.innerHTML="",e&&e.length>0?e.forEach(n=>{const a=document.createElement("div");a.className="store-card",a.innerHTML=`
          <h3>${n.name}</h3>
          <p>${n.address}</p>
          <p>ì „í™”: ${n.phone||"ì •ë³´ ì—†ìŒ"}</p>
          <p>ì˜ì—…ì‹œê°„: ${n.operatingHours||"ì •ë³´ ì—†ìŒ"}</p>
          <button class="store-details-btn" data-store-id="${n.id}">ìƒì„¸ë³´ê¸°</button>
        `,t.appendChild(a),a.querySelector(".store-details-btn").addEventListener("click",i=>{const r=i.target.dataset.storeId;console.log(`ë§¤ì¥ ìƒì„¸ë³´ê¸° í´ë¦­: ${r}`),window.MapPanelUI&&typeof window.MapPanelUI.renderStoreDetails=="function"&&window.MapPanelUI.renderStoreDetails(r)})}):t.innerHTML="<p>ì£¼ë³€ì— ë§¤ì¥ì´ ì—†ìŠµë‹ˆë‹¤.</p>"}};window.mapController=m;console.log("âœ… mapController ì „ì—­ ê°ì²´ ë“±ë¡ ì™„ë£Œ");async function d(){console.log("ğŸ—ºï¸ ì§€ë„ í˜ì´ì§€ ì§„ì… - ë ˆì´ì–´ë“œ ì•„í‚¤í…ì²˜ ë²„ì „");try{await m.initializeMap(),console.log("âœ… ì§€ë„ í˜ì´ì§€ ë Œë”ë§ ì™„ë£Œ")}catch(e){console.error("âŒ ì§€ë„ í˜ì´ì§€ ë Œë”ë§ ì‹¤íŒ¨:",e);const t=document.getElementById("main");t.innerHTML=`
      <div style="padding: 20px; text-align: center; color: red;">
        <h2>ğŸš« ì§€ë„ ë¡œë”© ì‹¤íŒ¨</h2>
        <p>ì§€ë„ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</p>
        <button onclick="location.reload()">ë‹¤ì‹œ ì‹œë„</button>
      </div>
    `}}window.renderMap=d;typeof module<"u"&&module.exports?module.exports=d:typeof window<"u"&&(window.renderMap=d);console.log("âœ… ë¦¬íŒ©í† ë§ëœ renderMap ëª¨ë“ˆ ë¡œë“œ ì™„ë£Œ (í˜¸í™˜ì„± í–¥ìƒ)");export{d as default};
